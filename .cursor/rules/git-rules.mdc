---
alwaysApply: true
---

# Git / GitHub ベストプラクティス

### 1. コミットメッセージ規約（Conventional Commits）
- **形式**: `<type>[optional scope]: <description>`
- **例**: `feat(auth): add multi-factor authentication support`
- **主なタイプ**:
  - `feat`: 新機能の追加
  - `fix`: バグ修正
  - `docs`: ドキュメントのみの変更
  - `style`: コードの動作に影響しない変更（フォーマット、セミコロンなど）
  - `refactor`: バグ修正や機能追加を伴わないコード変更
  - `perf`: パフォーマンス改善
  - `test`: テストの追加や修正
  - `chore`: ビルドプロセスや補助ツールの変更
  - `ci`: CI設定やスクリプトの変更
- **本文（body）**: 変更の理由や詳細を説明（必要に応じて）
- **フッター（footer）**: 破壊的変更や関連するIssue番号を記載（必要に応じて）

### 2. コミットの粒度
- **1つのコミットには1つの変更のみ**: 関連する変更はまとめるが、異なる目的の変更は分ける
- **論理的な単位でコミット**: 機能追加、バグ修正、リファクタリングなどは別々のコミットにする
- **小さなコミットを心がける**: 大きな変更は複数の小さなコミットに分割する
- **内容ごとに分割して別ブランチでコミット**: 複数の機能や変更がある場合は、それぞれを別々のブランチでコミットし、内容ごとに分割する
  - 例: カレンダー機能、打刻機能、集計機能などは別々のコミットにする
  - 例: ルール追加、ドキュメント更新、機能実装は別々のコミットにする
  - **重要**: 複数の機能や変更がある場合は、必ず別々のブランチを作成してからコミットする
    - 手順: 1) 現在の変更をリセット（`git reset HEAD`）、2) 機能ごとにブランチを作成（`git checkout -b feat/feature-name`）、3) 各ブランチでコミット、4) 必要に応じてprototypeブランチにマージ

### 3. ブランチ戦略
- **メインブランチ**: `main`ブランチを本番環境のコードとして管理
- **機能ブランチ**: 新機能やバグ修正は個別のブランチで作業（例: `feat/user-authentication`, `fix/login-bug`）
- **ブランチ名の規則**: 
  - `feat/` - 新機能
  - `fix/` - バグ修正
  - `docs/` - ドキュメント
  - `refactor/` - リファクタリング
  - `test/` - テスト
  - `chore/` - その他の変更
- **定期的なマージ**: メインブランチの変更を定期的に取り込む

### 4. プルリクエスト（PR）
- **明確なタイトル**: PRのタイトルは変更内容が分かるように記述
- **詳細な説明**: PRの説明欄に変更内容、理由、テスト方法を記載
- **関連Issueの参照**: 関連するIssue番号を記載（`Closes #123`など）
- **小さなPR**: 1つのPRは1つの変更に集中し、レビューしやすくする
- **レビューの依頼**: 適切なレビュアーを指定し、変更内容を確認してもらう

### 5. コードレビュー
- **建設的なフィードバック**: コードの品質向上を目的とした建設的なコメントを心がける
- **承認基準**: コードの動作確認、テストの確認、セキュリティチェックを行う
- **迅速な対応**: レビューリクエストは迅速に対応する

### 6. .gitignoreの管理
- **不要なファイルを除外**: `node_modules/`, `.env.local`, `.next/`, `dist/`などは必ず除外
- **環境固有のファイル**: 開発環境ごとに異なる設定ファイルは除外
- **ビルド成果物**: 自動生成されるファイルは除外
- **定期的な見直し**: `.gitignore`を定期的に見直し、不要なファイルがコミットされないようにする

### 7. READMEの管理
- **プロジェクトの概要**: プロジェクトの目的と概要を記載
- **セットアップ手順**: インストールとセットアップの手順を記載
- **使用方法**: 基本的な使用方法やコマンドを記載
- **コントリビューションガイド**: コントリビューション方法を記載（必要に応じて）
- **ライセンス**: ライセンス情報を記載

### 8. セキュリティ
- **機密情報の管理**: APIキー、パスワード、トークンなどは絶対にコミットしない
- **環境変数の使用**: 機密情報は環境変数で管理し、`.env.local`は`.gitignore`に含める
- **GitHub Secrets**: CI/CDで使用する機密情報はGitHub Secretsを使用
- **依存関係の更新**: セキュリティ脆弱性のある依存関係は定期的に更新

### 9. タグとリリース
- **セマンティックバージョニング**: バージョン番号は`MAJOR.MINOR.PATCH`形式で管理
- **リリースタグ**: リリースごとにタグを作成（例: `v1.0.0`）
- **リリースノート**: リリース内容を記載したリリースノートを作成

### 10. コミット履歴の整理
- **不要なコミットの統合**: 関連する小さなコミットは`git rebase -i`で統合
- **コミットメッセージの修正**: 誤字や不適切なメッセージは`git commit --amend`で修正
- **履歴のクリーンさ**: メインブランチの履歴は常にクリーンに保つ

### 11. マージ戦略
- **マージコミット**: 機能ブランチをマージする際は、可能であれば`--no-ff`でマージコミットを作成
- **Squashマージ**: 小さな変更や整理されたコミット履歴が必要な場合はSquashマージを検討
- **Rebase**: メインブランチの最新変更を取り込む際は`git rebase`を使用（共有ブランチでは注意）

### 12. コンフリクトの解決
- **定期的な同期**: メインブランチの変更を定期的に取り込み、コンフリクトを早期に発見
- **明確な解決**: コンフリクト解決後は動作確認を行い、不要なコードが残らないようにする
- **コミットメッセージ**: コンフリクト解決のコミットメッセージは明確に記述

参考: [Conventional Commits](https://www.conventionalcommits.org/)
